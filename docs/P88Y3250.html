---

title: 4FGL J1257.0-6339 (P88Y3250)


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/P88Y3250.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/P88Y3250.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">wtlike</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">utilities.ipynb_docgen</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">source_name</span> <span class="o">=</span> <span class="s1">&#39;4FGL J1257.0-6339&#39;</span>

<span class="k">def</span> <span class="nf">P88Y3250</span><span class="p">(</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ## Variability analysis of 4FGL J1257.0-6339</span>
<span class="sd">    {date}</span>
<span class="sd">    </span>
<span class="sd">    This source, ~$0.5^\circ$ distant from PSR B1259-63, has a nickname P88Y3250. </span>
<span class="sd">    I look at it because it was flagged as variable, index=48.3, so may affect B1259.</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    It is unassociated, with a pointlike TS=287, and flux uncertainty of 0.7%. Its 12-year SED is:</span>
<span class="sd">    </span>
<span class="sd">    {sed}</span>
<span class="sd">    </span>
<span class="sd">    {out1}</span>
<span class="sd">    </span>
<span class="sd">    {out2}</span>
<span class="sd">    </span>
<span class="sd">    Here is the light curve, measured in weekly intervals.</span>
<span class="sd">    {fig1}</span>
<span class="sd">    </span>
<span class="sd">    Note that most of the weeks are limits, except for a few quite significant ones.</span>
<span class="sd">    The blue line is the result of the Bayesian block (BB) analysis, which found several blocks. </span>
<span class="sd">    </span>
<span class="sd">    The BB fluxes with relative flux &gt;2:</span>
<span class="sd">    {bbflux}</span>
<span class="sd">    Here is a an expansion, in daily bins, following the 2017 B1259-63 periastron at 58018:</span>
<span class="sd">    </span>
<span class="sd">    {fig2}</span>

<span class="sd">    ### Comparison with the [LightCurveRepository](https://fermi.gsfc.nasa.gov/ssc/data/access/lat/LightCurveRepository/).</span>
<span class="sd">    </span>
<span class="sd">    {lc_image}</span>
<span class="sd">    This shows the energy flux for 3-day intervals, and appears to be consistent with the wtlike analysis.</span>
<span class="sd">    </span>
<span class="sd">    ### Conclusion</span>
<span class="sd">    </span>
<span class="sd">    This source is not variable--the apparent variability is entirely due to the flares from B1259-63.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
   
    <span class="n">sed</span> <span class="o">=</span> <span class="n">image</span><span class="p">(</span><span class="s1">&#39;P88Y3250_sed_uw1216.jpg&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    
    <span class="k">with</span> <span class="n">capture_print</span><span class="p">(</span><span class="s1">&#39;Output: load data, add weights, form time bins, fit&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out1</span><span class="p">:</span>
        <span class="n">weekly</span> <span class="o">=</span> <span class="n">WtLike</span><span class="p">(</span><span class="n">source_name</span><span class="p">)</span>
        
    <span class="k">with</span> <span class="n">capture_print</span><span class="p">(</span><span class="s1">&#39;BB partition output&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out2</span><span class="p">:</span>
        <span class="n">bbview</span> <span class="o">=</span> <span class="n">weekly</span><span class="o">.</span><span class="n">bb_view</span><span class="p">()</span>
        
    <span class="n">fig1</span> <span class="o">=</span><span class="n">figure</span><span class="p">(</span>
            <span class="n">bbview</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">ts_bar_min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">bbflux</span> <span class="o">=</span> <span class="n">monospace</span><span class="p">(</span><span class="n">bbview</span><span class="o">.</span><span class="n">fluxes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;flux&gt;2&#39;</span><span class="p">))</span>
    
    <span class="k">with</span> <span class="n">capture_print</span><span class="p">()</span> <span class="k">as</span> <span class="n">out3</span><span class="p">:</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span>
                <span class="n">weekly</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="mi">58050</span><span class="p">,</span> <span class="mi">58100</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">fignum</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    
    <span class="n">lc_image</span><span class="o">=</span><span class="n">image</span><span class="p">(</span><span class="s1">&#39;P88Y3250_light_curve.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">locals</span><span class="p">()</span>

<span class="c1"># runs the above, generates the doc</span>
<span class="n">nbdoc</span><span class="p">(</span><span class="n">P88Y3250</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Variability-analysis-of-4FGL-J1257.0-6339">Variability analysis of 4FGL J1257.0-6339<a class="anchor-link" href="#Variability-analysis-of-4FGL-J1257.0-6339"> </a></h2><p>2021-05-21 08:59</p>
<p>This source, ~$0.5^\circ$ distant from PSR B1259-63, has a nickname P88Y3250. 
I look at it because it was flagged as variable, index=48.3, so may affect B1259.</p>
<p>It is unassociated, with a pointlike TS=287, and flux uncertainty of 0.7%. Its 12-year SED is:</p>
<figure style="margin-left: 5%" title="Figure 1">  <a href="images/P88Y3250_fig_01.png" title="images/P88Y3250_fig_01.png">    <img src="images/P88Y3250_fig_01.png" alt="Figure 1 at images/P88Y3250_fig_01.png" width=250>   </a> </figure><p><details  class="nbdoc-description" >  <summary> Output: load data, add weights, form time bins, fit </summary>  <div style="margin-left: 5%"><pre>SourceData: photons and exposure for 4FGL J1257.0-6339: Restoring from cache with key "4FGL J1257.0-6339_data"<br>SourceData: Source 4FGL J1257.0-6339 with:<br>  data:     1,333,593 photons from 2008-08-04 to 2021-05-19<br>   exposure: 3,356,508 intervals,  average rate 3578 cm^2 for 100.2 Ms<br>     rates:  source 7.57e-09/s, background 3.71e-06/s, S/N ratio 2.04e-03<br>CellData: Bin photon data into 667 1-week bins from 54683.0 to 59352.0<br>LightCurve: select 660 cells for fitting with e&gt;1 & n&gt;2<br></pre></div> </details></p>
<p><details  class="nbdoc-description" >  <summary> BB partition output </summary>  <div style="margin-left: 5%"><pre>LightCurve: select 660 cells for fitting with e&gt;1 & n&gt;2<br>Bayesian Blocks: using penalty 0.05<br>Partitioned 660 cells into 9 blocks, using LikelihoodFitness <br>LightCurve: Loaded 9 / 9 cells for fitting<br></pre></div> </details></p>
<p>Here is the light curve, measured in weekly intervals.</p>
<figure style="margin-left: 5%" title="Figure 2">  <a href="images/P88Y3250_fig_02.png" title="images/P88Y3250_fig_02.png">    <img src="images/P88Y3250_fig_02.png" alt="Figure 2 at images/P88Y3250_fig_02.png" width=600>   </a> </figure><p>Note that most of the weeks are limits, except for a few quite significant ones.
The blue line is the result of the Bayesian block (BB) analysis, which found several blocks.</p>
<p>The BB fluxes with relative flux &gt;2:</p>
<p><div style="margin-left: 5%"><pre>         t     tw      n    ts   flux           errors  limit<br>1  55589.5   21.0   6199  41.2  13.21  (-2.506, 2.527)  17.40<br>3  56758.5  231.0  63904  56.3   3.59  (-0.522, 0.523)   4.45<br>5  57976.5  161.0  47067  25.6   2.60  (-0.544, 0.559)   3.54<br>6  58074.5   35.0  12436  52.0  10.21    (-1.66, 1.67)  12.97<br>8  59331.0   42.0  10859  45.4   9.85  (-1.723, 1.734)  12.72</pre></div>
Here is a an expansion, in daily bins, following the 2017 B1259-63 periastron at 58018:</p>
<figure style="margin-left: 5%" title="Figure 3">  <a href="images/P88Y3250_fig_03.png" title="images/P88Y3250_fig_03.png">    <img src="images/P88Y3250_fig_03.png" alt="Figure 3 at images/P88Y3250_fig_03.png" width=600>   </a> </figure><h3 id="Comparison-with-the-LightCurveRepository.">Comparison with the <a href="https://fermi.gsfc.nasa.gov/ssc/data/access/lat/LightCurveRepository/">LightCurveRepository</a>.<a class="anchor-link" href="#Comparison-with-the-LightCurveRepository."> </a></h3><p><figure style="margin-left: 5%" title="Figure 4">  <a href="images/P88Y3250_fig_04.png" title="images/P88Y3250_fig_04.png">    <img src="images/P88Y3250_fig_04.png" alt="Figure 4 at images/P88Y3250_fig_04.png" width=600>   </a> </figure>
This shows the energy flux for 3-day intervals, and appears to be consistent with the wtlike analysis.</p>
<h3 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion"> </a></h3><p>This source is not variable--the apparent variability is entirely due to the flares from B1259-63.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Implications-for-the-Catalog">Implications for the Catalog<a class="anchor-link" href="#Implications-for-the-Catalog"> </a></h1><p>This could be done with <strong>all</strong> 4FGL sources with a relatively small amount of effort.</p>
<p>Computing times to generate this:</p>
<ul>
<li>15' using pointlike to generate a table of weights for energy- and angle- regions</li>
<li>10' to load photons in the source region from the compressed FT1/FT2 table for the 11 2/3 years, and apply weights using the associated table.</li>
</ul>
<p>What would be needed:</p>
<ol>
<li>a systematic effort to produce such tables, using the official catalog model with fermipy for all sources.</li>
<li>Compare all lightcurves for nearby sources to check correlations: for such pairs, or groups, identify which is the culpit, and modify the background assumption for the neighbors. </li>
<li>A modification of wtlike to change the current background assumption, allowing it to have a fixed and a variable component</li>
</ol>
<p>Potential result: Detailed, and more reliable, light curves on any time scale for all sources.</p>
<p><strong>Can I enlist volunteer(s)?</strong> This especially applies to #1.</p>

</div>
</div>
</div>
</div>
 

