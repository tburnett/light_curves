---

title: poisson


keywords: fastai
sidebar: home_sidebar

summary: "Description of the class ``Poisson`, and its helper `PoissonFitter`, "
description: "Description of the class ``Poisson`, and its helper `PoissonFitter`, "
nb_path: "nbs/09_poisson.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/09_poisson.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Poisson" class="doc_header"><code>class</code> <code>Poisson</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/poisson.py#L9" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Poisson</code>(<strong><code>p</code></strong>:<code>array of parameters</code>)</p>
</blockquote>
<p>This is a Functor class which returns the log of a three-parameter Poisson-like function used to represent the flux likelihood
parameters are, in order:</p>
<p>$s_p$ : flux at peak, if positive; if negative, there is only a limit</p>
<p>$e$ : normalization factor to convert flux to equivalent counts. must be &gt;0</p>
<p>$b$  : background flux: must be &gt;=0</p>
<p>This parameterization is equivalent to that described in William
Tompkins' thesis (arxiv: astro-ph/0202141) and Nolan, et al., 2003,
ApJ 597:615:627. The functional form is that of a Poisson distribution</p>
<p>The log likelihood expression is for flux $s&gt;=0$
   $$w(s | s_p,e,b) = e\ (s_p+b) \ \log[ e\ (s+b) ] - e\ s + \mathrm{const}$$
the const is such that $w=0$ at the peak.</p>
<p>A slightly more elegant expression, used in the cdf function, is to define
   $\beta = e b$,
   $\mu = e s_p + \beta$, and
   $x = e s$
Then the log likelihood is</p>
<p>$$ w'(x) =  \mu \ \log( x + \beta) - x + \mathrm{const}$$</p>
<p>where the peak is at $x=x_p=max(0, \mu-\beta)$, and the constant is defined so that $w'(x_p)=0$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Poisson.__call__" class="doc_header"><code>Poisson.__call__</code><a href="__main__.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Poisson.__call__</code>(<strong><code>dom</code></strong>)</p>
</blockquote>
<p>Return the value(s) of the fit function for the given domain.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Poisson-document">Poisson document<a class="anchor-link" href="#Poisson-document"> </a></h3><p>Here we generate and plot several instances, all with the $e$ parameter set to one, so the flux is in counts.</p>
<p>The peak ($s_p$) and  background ($b$) parameters are chosen from the following list:</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 1)]</samp></p><p>The first two, with the peak at 10, show the effect of background. The last two show an example with a
peak less than zero, so that the Bayesian likelihood peaks at zero, and the effect of background on it.</p>
<div class="jupydoc_fig"><a href="images/poisson_doc_fig_01.png"<figure>   <img src="images/poisson_doc_fig_01.png" alt="Figure 1 at images/poisson_doc_fig_01.png" >  <figcaption><b>Figure 1</b>. Poisson-like plots</figcaption></figure></a></div><hr>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PoissonFitter" class="doc_header"><code>class</code> <code>PoissonFitter</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/poisson.py#L173" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PoissonFitter</code>(<strong><code>func</code></strong>, <strong><code>fmax</code></strong>=<em><code>None</code></em>, <strong><code>scale</code></strong>=<em><code>None</code></em>, <strong><code>tol</code></strong>=<em><code>0.2</code></em>, <strong><code>delta</code></strong>=<em><code>0.0001</code></em>, <strong><code>dd</code></strong>=<em><code>-0.1</code></em>, <strong><code>test_mode</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Helper class to fit a log likelihood function to the Poisson</p>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>User function usage failed: name &#39;capture_print&#39; is not defined
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

