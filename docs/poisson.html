---

title: poisson


keywords: fastai
sidebar: home_sidebar



nb_path: "00_poisson.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_poisson.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Poisson" class="doc_header"><code>class</code> <code>Poisson</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/poisson.py#L9" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Poisson</code>(<strong><code>p</code></strong>:<code>array of parameters</code>)</p>
</blockquote>
<p>log of the three-parameter Poisson-like function used to represent the flux likelihood
parameters are, in order:</p>
<p>$s_p$ : flux at peak, if positive; if negative, there is only a limit</p>
<p>$e$ : normalization factor to convert flux to equivalent counts. must be &gt;0</p>
<p>$b$  : background flux: must be &gt;=0</p>
<p>This parameterization is equivalent to that described in William
Tompkins' thesis (arxiv: astro-ph/0202141) and Nolan, et al., 2003,
ApJ 597:615:627. The functional form is that of a Poisson distribution</p>
<p>The log likelihood expression is for flux $s&gt;=0$
   $$w(s | s_p,e,b) = e\ (s_p+b) \ \log[ e\ (s+b) ] - e\ s + \mathrm{const}$$
the const is such that $w=0$ at the peak.</p>
<p>A slightly more elegant expression, used in the cdf function, is to define
   $\beta = e b$,
   $\mu = e s_p + \beta$, and
   $x = e s$
Then the log likelihood is</p>
<p>$$ w'(x) =  \mu \ \log( x + \beta) - x + \mathrm{const}$$</p>
<p>where the peak is at x=x_p=max(0, mu-beta), and the constant is defined so that $w'(x_p)=0$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Poisson.__call__" class="doc_header"><code>Poisson.__call__</code><a href="__main__.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Poisson.__call__</code>(<strong><code>dom</code></strong>)</p>
</blockquote>
<p>Return the value(s) of the fit function for the given domain.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Poisson-document">Poisson document<a class="anchor-link" href="#Poisson-document"> </a></h3><p>Here we generate and plot several instances, all with the $e$ parameter set to one, so the flux is in counts.</p>
<p>The peak ($s_p$) and  background ($b$) parameters are chosen from the following list:</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 1)]</samp></p><p>The first two, with the peak at 10, show the effect of background. The last two show an example with a
peak less than zero, so that the Bayesian likelihood peaks at zero, and the effect of background on it.</p>
<div class="jupydoc_fig"><figure>   <img src="images/poisson_doc_fig_01.png" alt="Figure 1 at images/poisson_doc_fig_01.png" > </figure></div><hr>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PoissonFitter" class="doc_header"><code>class</code> <code>PoissonFitter</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/poisson.py#L173" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PoissonFitter</code>(<strong><code>func</code></strong>, <strong><code>fmax</code></strong>=<em><code>None</code></em>, <strong><code>scale</code></strong>=<em><code>None</code></em>, <strong><code>tol</code></strong>=<em><code>0.2</code></em>, <strong><code>delta</code></strong>=<em><code>0.0001</code></em>, <strong><code>dd</code></strong>=<em><code>-0.1</code></em>, <strong><code>test_mode</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Helper class to fit a log likelihood function to the Poisson</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="PoissonFitter-Usage-example">PoissonFitter Usage example<a class="anchor-link" href="#PoissonFitter-Usage-example"> </a></h3><p>If <code>func</code> is a log-likelihood function, the parameterized fit object is returned by</p>

<pre><code>fpois = PoissonFitter(func).poiss</code></pre>
<p>Test by fitting to the same functions generated in the  <code>Poisson</code> test/demo,
the  ($s_p, b$) pairs.</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 0.5)]</samp></p><p>The output shows the maximum error and the fit parameters for each test:</p>
<p style="margin-left: 5%"><pre>error: 2.3e-05, fit: [10.     1.     5.001]<br>error: 5.5e-04, fit: [9.997 1.    0.   ]<br>error: 8.6e-13, fit: [-1.  1.  1.]<br>error: 4.5e-02, fit: [-1.     9.999  1.   ]<br></pre></p><p>Here are plots of the probability, created with <code>PoissonFitter.plot</code>, showing the input function, 
and the points that were used for the evaluation, with the output function as a dashed line.</p>
<div class="jupydoc_fig"><figure>   <img src="images/usage_fig_01.png" alt="Figure 1 at images/usage_fig_01.png" width=600>  <figcaption><b>Figure 1</b>. Fit examples.</figcaption></figure></div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

