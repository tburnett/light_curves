---

title: Simulation


keywords: fastai
sidebar: home_sidebar

summary: "Generate simulated cells"
description: "Generate simulated cells"
nb_path: "nbs/08_simulation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/08_simulation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Sampler" class="doc_header"><code>class</code> <code>Sampler</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/simulation.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Sampler</code>(<strong><code>func</code></strong>, <strong><code>a</code></strong>=<em><code>0</code></em>, <strong><code>b</code></strong>=<em><code>1</code></em>, <strong><code>n</code></strong>=<em><code>100</code></em>)</p>
</blockquote>
<p>Sample an arbitrary function or histogram</p>
<ul>
<li>func -- the function, or a histogram</li>
<li>a,b  -- limits (default 0,1)</li>
<li>n    -- table size (ignored if a histogram)</li>
</ul>
<p>Note the property <code>mean</code> is the expected mean.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tests:--Gaussian-and-quadratic">Tests:  Gaussian and quadratic<a class="anchor-link" href="#Tests:--Gaussian-and-quadratic"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">Sampler</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sf</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">tests</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">tests</span><span class="o">&lt;</span><span class="mf">5e-2</span> <span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;Failed Tests: mean </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s1">, std </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">wfun</span> <span class="o">=</span> <span class="n">Sampler</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">test2</span> <span class="o">=</span> <span class="n">wfun</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wfun</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">test2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">test2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Not almost equal: </span><span class="si">{</span><span class="n">test2</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WeightGenerator" class="doc_header"><code>class</code> <code>WeightGenerator</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/simulation.py#L52" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WeightGenerator</code>(<strong><code>func</code></strong>, <strong><code>alpha</code></strong>=<em><code>0</code></em>, <strong><code>beta</code></strong>=<em><code>0</code></em>, <strong><code>n</code></strong>=<em><code>100</code></em>) :: <a href="/light_curves/simulation.html#Sampler"><code>Sampler</code></a></p>
</blockquote>
<p>Generate a set of weights</p>
<ul>
<li><code>func</code> -- nominal weight distribution function, evaluated on (0,1)</li>
<li><code>alpha, beta</code> -- (default 0,0). Values for $\alpha$, $\beta$.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>      
<span class="n">wg</span> <span class="o">=</span> <span class="n">WeightGenerator</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">wg</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wg</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">test2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">test2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Not almost equal: </span><span class="si">{</span><span class="n">test2</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">test2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.7199871931569316, 0.7229479245367344)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_cell" class="doc_header"><code>generate_cell</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/simulation.py#L69" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_cell</code>(<strong><code>wfun</code></strong>, <strong><code>mu</code></strong>, <strong><code>alpha</code></strong>=<em><code>0</code></em>, <strong><code>beta</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>Generate a cell</p>
<ul>
<li><code>wfun</code> -- weight function, or histogram.
  Defined on (0,1)</li>
<li><code>mu</code> -- number of expected weights, on average</li>
<li><code>alpha</code>, <code>beta</code>  -- default 0,0; values for $\alpha$ and  $\beta$ for this cell</li>
</ul>
<p>Returns a dict with:</p>
<ul>
<li><code>n</code> -- actual generated number of weights, from Poisson</li>
<li><code>w</code> -- array of weights * 256, as  uint8 integers</li>
<li><code>S, B</code> -- expected values for $\sum w$ and $\sum(1-w)$, calulated from wfun</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test with a function peaked at both ends, generate equal signal and background</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_hide</span>
<span class="k">def</span> <span class="nf">test_gen</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">wfun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test with alpha=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">, beta=</span><span class="si">{</span><span class="n">beta</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">generate_cell</span><span class="p">(</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span>  <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">beta</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="n">LogLike</span><span class="p">(</span><span class="n">cell</span><span class="p">);</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Generated cell info:</span><span class="se">\n</span><span class="si">{</span> <span class="n">ll</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">fit</span> <span class="o">=</span> <span class="n">ll</span><span class="o">.</span><span class="n">fit_info</span><span class="p">(</span><span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">2</span> <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">1</span><span class="si">}</span><span class="s1">-D fit info:</span><span class="se">\n</span><span class="si">{</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">sigt</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="p">),</span>  <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sig_flux&#39;</span><span class="p">]</span>
    <span class="n">check_alpha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span>  <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="o">*</span><span class="n">sigt</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;alpha: abs(</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">) &gt; </span><span class="si">{</span><span class="n">tol</span><span class="si">}</span><span class="s1"> * </span><span class="si">{</span><span class="n">sigt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_alpha</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;Failed: </span><span class="si">{</span><span class="n">check_alpha</span><span class="si">}</span><span class="s1"> &#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">sigt</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">beta</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sig_beta&#39;</span><span class="p">]</span>
        <span class="n">check_beta</span> <span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="o">*</span><span class="n">sigt</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;beta: abs(</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">) &gt; </span><span class="si">{</span><span class="n">tol</span><span class="si">}</span><span class="s1"> * </span><span class="si">{</span><span class="n">sigt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_alpha</span><span class="p">)</span>  <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_beta</span><span class="p">)),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">check_alpha</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">check_beta</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="c1">#test_gen(10, 0, tol=5, quiet=False)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Test with alpha=0.1, beta=None
Generated cell info:
light_curves.loglike.LogLike:  10386 weights, S 4998.5, B 5001.5
1-D fit info:
counts      10386.000
flux            1.101
sig_flux        0.016
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-a-set-of-poisson-like-fits-to-the-likelihoods">Generate a set of poisson-like fits to the likelihoods<a class="anchor-link" href="#Generate-a-set-of-poisson-like-fits-to-the-likelihoods"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pfit</span><span class="o">.</span><span class="n">flux</span> <span class="k">for</span> <span class="n">pfit</span> <span class="ow">in</span> <span class="n">pfits</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">((</span><span class="n">flux</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">flux</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;pull&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQcAAAEGCAYAAABo91ACAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAANlUlEQVR4nO3dbYwd512G8evGwVRAMQLXQloHTsBRVKsgVawSrCIR0Rc5JE5QkWiMQC1EsQoEtSoRcigS8AERCYmXKIFooVFatSSKQqF2kyoURBSKDMoLaRvXBKzoQLYBmS6Si/gSpf7zYdew3Ty25+w5e2ZsX78v3jN7dub22d17Z56ZeU6qCkna6Bv6DiBpmCwHSU2Wg6Qmy0FSk+UgqemKvgMA7Ny5s0aj0dy3++qrr7J9+/a5b3cSZpze0PNBfxmfffbZr1TVm1qfG0Q5jEYjnnnmmblvdzwe00cpTcKM0xt6PugvY5J/Pdfnej2sSHIgydLp06f7jCGpoddyqKqjVXVox44dfcaQ1OCApKQmy0FSk+UgqclykNRkOUhqshwkNVkOkposB0lNvV4+neQAcGDPnj19xtAGo8OPTfT8fbvOcOzU8U7PHd9942YiqQdeISmpaRA3XmmYuv6V73LT0KR7I+qfYw6SmiwHSU2Wg6QmxxwuIx73axKWg+aqa0F5yrN/lsNlyF88dWE5aC66FpKHPsPhgKSkJstBUpPlIKnJcpDUZDlIapp5OSR5c5L7kzya5OdnvX5J89GpHJI8kORUkhc2LN+f5MUkJ5McBqiqE1X1fuAngcXZR5Y0D133HB4E9q9fkGQbcB9wA7AXOJhk79rnbgY+B/z1zJJKmqtOF0FV1VNJRhsWXwucrKqXAJI8DNwCfKmqjgBHkjwG/GlrnUkOAYcAFhYWGI/Hm8k/lZWVlblvc1JdMt71yS92Wte+Xav/zvq1nuXruG/XGWC2GS+V7/O8TXOF5ALw8rrHy8B1Sa4H3g18E/D4ub64qpaAJYDFxcXq612Qh/7uy3DhjF2naOu6vs2Y1TrP/l9mnfFS+D7P2zTlkMayqqongSenWK82yXsmNEvTlMMycOW6x7uBVyZZgRPM6ly8e7N/05zKfBq4OslVSbYDtwJHJlmBE8xKw9VpzyHJQ8D1wM4ky8CvV9VHktwBPAFsAx6oqskOfqUNvHtzOLqerTh4juWPc55BxwvxsEIaLt+3QlKT91ZIarIcJDX1Wg5JDiRZOn36dJ8xJDU45iCpycMKSU2Wg6QmxxwkNTnmIKnJwwpJTZaDpCbLQVKTA5KSmhyQlNTku2wP2OjwY+zbdWbiOSIvJ13mddi36wwPfWi09WEuMY45SGpyz+Ei4DyJr+eMUVvPAUlJTQ5ISmpyzEFSk+UgqclykNRkOUhqshwkNVkOkpq8zkFSk9c5SGrysEJSk+UgqclykNRkOUhqshwkNVkOkposB0lNloOkJstBUlOvc0gmOQAc2LNnT58xdBnoOpek83X+Py+fltTk7NO6pI3vvpHxeMxoNDrv85yl+vUcc5DUZDlIarIcJDVZDpKaLAdJTZaDpCZPZfbA02a6GLjnIKnJPYcedblUdzweb30QqcE9B0lNloOkJstBUtOWlEOSH0/yx0k+leRdW7ENSVurczkkeSDJqSQvbFi+P8mLSU4mOQxQVX9RVbcD7wPeM9PEkuZikj2HB4H96xck2QbcB9wA7AUOJtm77im/tvZ5SReZzqcyq+qpJKMNi68FTlbVSwBJHgZuSXICuBv4TFU911pfkkPAIYCFhYVeTtmtrKzMfZsA+3adAbqdpuwr4ySGnrFLvkm+J1thiK/htNc5LAAvr3u8DFwH/BLwDmBHkj1Vdf/GL6yqJWAJYHFxsS40GcdW6WO7x04dn2jbfb02kxh6xgvlm/R7shWG9hpOWw5pLKuquge4Z8p1S+rRtGcrloEr1z3eDbzS9YuTHEiydPr06SljSJq1acvhaeDqJFcl2Q7cChzp+sVOMCsN1ySnMh8CjgHXJFlOcltVvQbcATwBnAAeqarjWxNV0jxNcrbi4DmWPw48vpmN+74V0nD5vhWSmry3QlJTr+Xg2QppuDyskNTkYYWkJstBUpNjDpKaHHOQ1ORhhaQmy0FSk+9bMUO+k5UuJQ5ISmrqdc+hqo4CRxcXF2/vM8esdXknK2noPKyQ1pnk0PBS/yPggKSkJvccJCbbC7hcBp7dc5DU5NkKSU1ePi2pycMKSU2Wg6Qmy0FSk+UgqclykNRkOUhq8joHSU1e5yCpycMKSU2Wg6Qmy0FSk+UgqclykNRkOUhqshwkNTlNnLRJXaeLu1gnovUKSUlNvm+FNKGuewIX+0S0jjlIarIcJDVZDpKaLAdJTZaDpCbLQVKT5SCpyXKQ1GQ5SGqyHCQ1WQ6SmiwHSU2Wg6SmmZdDku9N8pEkj8563ZLmp1M5JHkgyakkL2xYvj/Ji0lOJjkMUFUvVdVtWxFW0vx0nc/hQeBe4GNnFyTZBtwHvBNYBp5OcqSqvjTrkH272O/LlzajUzlU1VNJRhsWXwucrKqXAJI8DNwCdCqHJIeAQwALCwuMx+NuiWdoZWWl0/P27Toz0Xpn+X/pmrFPQ8/YV76zPzddfh6G+BpOMxPUAvDyusfLwHVJvhP4LeCtSe6qqt9ufXFVLQFLAIuLizUajaaIsnldtnvs1HGgv7kA+3ptJjH0jH3kO/tz03XbQ3sNpymHNJZVVa0A759ivZIGYJqzFcvAlese7wZemWQFTjArDdc05fA0cHWSq5JsB24Fjkyygqo6WlWHduzYMUUMSVuh66nMh4BjwDVJlpPcVlWvAXcATwAngEeq6vjWRZU0T13PVhw8x/LHgcc3u/EkB4ADe/bs2ewqJG2RXi+f9rBCGi7vrZDUZDlIavK9MiU1OeYgqcnDCklNloOkJsccJDU55iCpycMKSU2Wg6Qmy0FSkwOSkpockJTU5GGFpCbLQVKT5SCpyXKQ1OTZCklNnq2Q1ORhhaQmy0FSk+UgqclykNRkOUhq8lSmpCZPZUpq8rBCUpPlIKnJcpDUZDlIarIcJDVZDpKaLAdJTZaDpKYr+g4gXepGhx+74HP27TrDsVPHO61vfPeN00bqxMunJTX1uudQVUeBo4uLi7f3mUPaCpP8hR+Px4xGo/M+p8seyCw55iCpyXKQ1GQ5SGqyHCQ1WQ6SmiwHSU2Wg6Qmy0FSk+UgqclykNRkOUhqshwkNVkOkppmfldmkm8B/hB4FXiyqj4x621I2nqd9hySPJDkVJIXNizfn+TFJCeTHF5b/G7g0aq6Hbh5xnklzUnXPYcHgXuBj51dkGQbcB/wTmAZeDrJEWA38MW1p31tZklnbHT4sYlm35EuN53KoaqeSjLasPha4GRVvQSQ5GHgFlaLYjfwPOfZM0lyCDgEsLCwwHg8njD6dPbtOsP3vbGAM52/Zt4ZAVZWVua+zUkNPePQ80G3jPt2rf6szuvncJoxhwXg5XWPl4HrgHuAe5PcCBw91xdX1RKwBLC4uFgXmgVn1lb3GM7w0IcOzHW7mzHv12Yzhp5x6PngwhnP7uXO6/8yTTmksayq6n+An51ivZIGYJpTmcvAlese7wZemWQFTjArDdc05fA0cHWSq5JsB24Fjkyygqo6WlWHduzYMUUMSVuh66nMh4BjwDVJlpPcVlWvAXcATwAngEeqyqF/6RKRqupv48kB4ADwHuBfeoiwE/hKD9udhBmnN/R80F/G76mqN7U+0Ws59C3JM1W12HeO8zHj9IaeD4aZ0XsrJDVZDpKaLvdyWOo7QAdmnN7Q88EAM17WYw6Szu1y33OQdA6Wg6Qmy2FNkjuTVJKdfWfZKMnvJPmnJF9I8udJvr3vTHDO+TwGI8mVSf4myYkkx5N8oO9MLUm2JfnHJJ/uO8t6lgOrP0Sszkvxb31nOYfPAm+pqh8A/hm4q+c86+fzuAHYCxxMsrffVK/zGvDLVfVm4IeAXxxgRoAPsHqV8aBYDqt+D/gVYJCjs1X1l2uXqwP8Pas3ufXt/+bzqKpXgbPzeQxGVf17VT239vF/s/oLuNBvqq+XZDdwI/AnfWfZ6LIvhyQ3A1+uqs/3naWjnwM+03cI2vN5DOoXb721yYreCvxDv0le5/dZ/cPUfdahOZn5BLNDlOSvgO9qfOrDwK8C75pvotc7X8aq+tTacz7M6q7yECbtbc7nMfcUHST5VuDPgA9W1Vf7znNWkpuAU1X1bJLr+86z0WVRDlX1jtbyJN8PXAV8Pgms7q4/l+TaqvqPOUY8Z8azkrwXuAl4ew3j4pSp5/OYhyTfyGoxfKKqPtl3ng3eBtyc5MeANwDfluTjVfXTPecCvAjq6yQZA4tVNag7+JLsB34X+JGq+s++8wAkuYLVwdG3A19mdX6PnxrSbftZbfyPAv9VVR/sO8/5rO053FlVN/Wd5azLfszhInEv8Ebgs0meT3J/34Eukvk83gb8DPCja6/b82t/pdWBew6SmtxzkNRkOUhqshwkNVkOkposB0lNloNmKsn7kty79vFvJLmz70zaHMtBUpPloPNKMlqbS+Kja/NJPJrkm5OMz859kWQxyZM9R9WMWQ7q4hpgaW0+ia8Cv9BzHs2B5aAuXq6qv1v7+OPAD/cZRvNhOaiLjdfYF6u3jp/9+XnDfONoHiwHdfHdSfatfXwQ+BwwBn5wbdlP9BFKW8tyUBcngPcm+QLwHcAfAb8J/EGSvwW+1mc4bQ3vytR5rU2v9umqekvPUTRn7jlIanLPQVKTew6SmiwHSU2Wg6Qmy0FSk+Ugqel/AbO3SKTlnQpbAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compare observed std with means</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">uppers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">flux</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pfits</span><span class="p">])</span>
<span class="n">lowers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">flux</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pfits</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean errors: </span><span class="si">{</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">uppers</span><span class="p">)</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lowers</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, STD: </span><span class="si">{</span><span class="n">flux</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> &#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>mean errors: 0.164, STD: 0.167 
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

