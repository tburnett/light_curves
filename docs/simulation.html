---

title: Simulation


keywords: fastai
sidebar: home_sidebar

summary: "Generate simulated cells using the weighted likelihood"
description: "Generate simulated cells using the weighted likelihood"
nb_path: "nbs/09_simulation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/09_simulation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Sampler" class="doc_header"><code>class</code> <code>Sampler</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/simulation.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Sampler</code>(<strong><code>func</code></strong>, <strong><code>limits</code></strong>=<em><code>(0, 1)</code></em>, <strong><code>n</code></strong>=<em><code>100</code></em>)</p>
</blockquote>
<p>Sample an arbitrary function or histogram</p>
<ul>
<li>func -- the function, or a histogram</li>
<li>a,b  -- limits (default 0,1)</li>
<li>n    -- table size (ignored if a histogram)</li>
</ul>
<p>Note the property <code>mean</code> is the expected mean.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Sampler</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sampler-tests:--Gaussian-and-quadratic-functions">Sampler tests:  Gaussian and quadratic functions<a class="anchor-link" href="#Sampler-tests:--Gaussian-and-quadratic-functions"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">Sampler</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sf</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">tests</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">tests</span><span class="o">&lt;</span><span class="mf">5e-2</span> <span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;Failed Tests: mean </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s1">, std </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">wfun</span> <span class="o">=</span> <span class="n">Sampler</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

<span class="n">test2</span> <span class="o">=</span> <span class="n">wfun</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wfun</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">test2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">test2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Not almost equal: </span><span class="si">{</span><span class="n">test2</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WeightGenerator" class="doc_header"><code>class</code> <code>WeightGenerator</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/simulation.py#L54" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WeightGenerator</code>(<strong><code>func</code></strong>, <strong><code>alpha</code></strong>=<em><code>0</code></em>, <strong><code>beta</code></strong>=<em><code>0</code></em>, <strong><code>n</code></strong>=<em><code>100</code></em>) :: <a href="/light_curves/simulation.html#Sampler"><code>Sampler</code></a></p>
</blockquote>
<p>Generate a set of weights</p>
<ul>
<li><code>func</code> -- nominal weight distribution function, evaluated on (0,1)</li>
<li><code>alpha, beta</code> -- (default 0,0). Values for $\alpha$, $\beta$.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>      
<span class="n">wg</span> <span class="o">=</span> <span class="n">WeightGenerator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">wg</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wg</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">test2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">test2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Not almost equal: </span><span class="si">{</span><span class="n">test2</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_cell" class="doc_header"><code>generate_cell</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/simulation.py#L71" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_cell</code>(<strong><code>wfun</code></strong>, <strong><code>mu</code></strong>, <strong><code>alpha</code></strong>=<em><code>0</code></em>, <strong><code>beta</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>Generate a cell</p>
<ul>
<li><code>wfun</code> -- weight function, or histogram.
  Defined on (0,1)</li>
<li><code>mu</code> -- number of expected weights, on average</li>
<li><code>alpha</code>, <code>beta</code>  -- default 0,0; values for $\alpha$ and  $\beta$ for this cell</li>
</ul>
<p>Returns a dict with:</p>
<ul>
<li><code>n</code> -- actual generated number of weights, from Poisson</li>
<li><code>w</code> -- array of weights</li>
<li><code>S, B</code> -- expected values for $\sum w$ and $\sum(1-w)$, calulated from wfun</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test with a function peaked at both ends, generate equal signal and background</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_gen</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">wfun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test with alpha=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">, beta=</span><span class="si">{</span><span class="n">beta</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">generate_cell</span><span class="p">(</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span>  <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">beta</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="n">LogLike</span><span class="p">(</span><span class="n">cell</span><span class="p">);</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Generated cell info:</span><span class="se">\n</span><span class="si">{</span> <span class="n">ll</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">fit</span> <span class="o">=</span> <span class="n">ll</span><span class="o">.</span><span class="n">fit_info</span><span class="p">(</span><span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">2</span> <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">1</span><span class="si">}</span><span class="s1">-D fit info:</span><span class="se">\n</span><span class="si">{</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">sigt</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="p">),</span>  <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sig_flux&#39;</span><span class="p">]</span>
    <span class="n">check_alpha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span>  <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="o">*</span><span class="n">sigt</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;alpha: abs(</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">) &gt; </span><span class="si">{</span><span class="n">tol</span><span class="si">}</span><span class="s1"> * </span><span class="si">{</span><span class="n">sigt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_alpha</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;Failed: </span><span class="si">{</span><span class="n">check_alpha</span><span class="si">}</span><span class="s1"> &#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">sigt</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">beta</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sig_beta&#39;</span><span class="p">]</span>
        <span class="n">check_beta</span> <span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="o">*</span><span class="n">sigt</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;beta: abs(</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">) &gt; </span><span class="si">{</span><span class="n">tol</span><span class="si">}</span><span class="s1"> * </span><span class="si">{</span><span class="n">sigt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_alpha</span><span class="p">)</span>  <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_beta</span><span class="p">)),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">check_alpha</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">check_beta</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="c1">#test_gen(10, 0, tol=5, quiet=False)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Test with alpha=0.1, beta=None
Generated cell info:
light_curves.loglike.LogLike:  10435 weights, S 4998.5, B 5001.5
1-D fit info:
counts      10435.000
flux            1.084
sig_flux        0.016
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-a-set-of-poisson-like-fits-to-the-likelihoods">Generate a set of poisson-like fits to the likelihoods<a class="anchor-link" href="#Generate-a-set-of-poisson-like-fits-to-the-likelihoods"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fmean</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">alpha</span>
<span class="k">def</span> <span class="nf">pull</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>  <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">errors</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span><span class="o">-</span><span class="n">l</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">fmean</span><span class="p">)</span><span class="o">/</span><span class="n">s</span>
<span class="n">pulls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">pull</span><span class="p">,</span> <span class="n">pfits</span><span class="p">)))</span>
<span class="n">pulls</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">pulls</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(-0.06278923607867916, 1.0239380269983502)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pfit</span><span class="o">.</span><span class="n">flux</span> <span class="k">for</span> <span class="n">pfit</span> <span class="ow">in</span> <span class="n">pfits</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">((</span><span class="n">flux</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="n">flux</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;pull&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compare observed std with means</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">uppers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">flux</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pfits</span><span class="p">])</span>
<span class="n">lowers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">flux</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pfits</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean errors: </span><span class="si">{</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">uppers</span><span class="p">)</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lowers</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, STD: </span><span class="si">{</span><span class="n">flux</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> &#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>mean errors: 0.165, STD: 0.166 
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

