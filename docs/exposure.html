---

title: Exposure


keywords: fastai
sidebar: home_sidebar

summary: "calculate exposure for a point source from a GTI and FT2 files"
description: "calculate exposure for a point source from a GTI and FT2 files"
nb_path: "nbs/03_exposure.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/03_exposure.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_exposure" class="doc_header"><code>get_exposure</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/exposure.py#L126" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_exposure</code>(<strong><code>config</code></strong>, <strong><code>files</code></strong>, <strong><code>gti</code></strong>, <strong><code>source</code></strong>, <strong><code>use_cache</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Return the exposure for the source
If gti is None, regenerate it</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">light_curves.config</span> <span class="kn">import</span> <span class="n">Config</span><span class="p">,</span> <span class="n">Files</span><span class="p">,</span> <span class="n">PointSource</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">Files</span><span class="p">()</span>
<span class="n">config</span><span class="o">=</span><span class="n">Config</span><span class="p">()</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">PointSource</span><span class="p">(</span><span class="s1">&#39;Geminga&#39;</span><span class="p">)</span>

<span class="n">exposure</span> <span class="o">=</span> <span class="n">get_exposure</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Processing 11 FITS files with GTI information ...  11 files, 63635 intervals with 3,322 days live time
	GTI MJD range: 54682.66-58698.08, good fraction 0.83 
Processing 12 S/C history (FT2) files
  applying cuts cos(theta) &lt; 0.4,  z &lt; 100
	file /home/burnett/work/lat-data/ft2/ft2_2008.fits: 362996 entries, 360944 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2009.fits: 874661 entries, 870446 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2010.fits: 889547 entries, 884697 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2011.fits: 882832 entries, 871672 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2012.fits: 881317 entries, 868109 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2013.fits: 885307 entries, 867342 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2014.fits: 894730 entries, 886570 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2015.fits: 890006 entries, 886086 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2016.fits: 890933 entries, 884823 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2017.fits: 888349 entries, 883761 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2018.fits: 842824 entries, 830723 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2019.fits: 737029 entries, 514657 in GTI
	Found 9,609,830 S/C entries:  2,695,715 remain after zenith and theta cuts
Calculate exposure using the energy domain 100.0-1000000.0 4 bins/decade
saving exposure to /tmp/light_curves/Geminga_exposure.pkl
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The result is a tuple of time intervals and the exposure</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">exposure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exposure</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                start          stop       exposure
0        54682.656038  54682.656375  112998.052089
1        54682.656375  54682.656722  116901.160578
2        54682.656722  54682.657069  116857.143435
3        54682.657069  54682.657416  116791.434285
4        54682.657416  54682.657764  116876.550059
...               ...           ...            ...
9609753  58698.052602  58698.052949   52427.727986
9609754  58698.052949  58698.053296   49343.687807
9609755  58698.053296  58698.053643   44567.360241
9609756  58698.053643  58698.053991   38779.120217
9609757  58698.053991  58698.054338   31786.491045

[2695715 rows x 3 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ecache</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">cache</span><span class="o">/</span><span class="s1">&#39;exposure.pkl&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">ecache</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">verbose</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;saving exposure to </span><span class="si">{</span><span class="n">ecache</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">exposure</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">ecache</span><span class="p">)</span>
    
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">verbose</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;restoring exposure from </span><span class="si">{</span><span class="n">ecache</span><span class="si">}</span><span class="s1"> &#39;</span> <span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">exposure</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">ecache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">verbose</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exposure</span><span class="p">)</span><span class="si">}</span><span class="s1"> entries, MJD </span><span class="si">{</span><span class="n">exposure</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">&#39;</span>
              <span class="sa">f</span><span class="s1">&#39; - </span><span class="si">{</span><span class="n">exposure</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

