---

title: exposure


keywords: fastai
sidebar: home_sidebar

summary: "calculate exposure for a point source from a GTI and FT2 files"
description: "calculate exposure for a point source from a GTI and FT2 files"
nb_path: "nbs/03_exposure.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/03_exposure.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_exposure" class="doc_header"><code>get_exposure</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/exposure.py#L125" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_exposure</code>(<strong><code>config</code></strong>, <strong><code>files</code></strong>, <strong><code>gti</code></strong>, <strong><code>source</code></strong>)</p>
</blockquote>
<p>Return the exposure for the source
If gti is None, regenerate it</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">light_curves.config</span> <span class="kn">import</span> <span class="n">LCconfig</span><span class="p">,</span> <span class="n">FileConfiguration</span><span class="p">,</span> <span class="n">PointSource</span>
<span class="c1"># To speed up test, reduce MJD range</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">LCconfig</span><span class="p">(</span><span class="n">mjd_range</span><span class="o">=</span><span class="p">(</span><span class="mi">54682</span><span class="p">,</span><span class="mi">55000</span> <span class="p">))</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">FileConfiguration</span><span class="p">()</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">PointSource</span><span class="p">(</span><span class="s1">&#39;Geminga&#39;</span><span class="p">)</span>

<span class="n">exposure</span> <span class="o">=</span> <span class="n">get_exposure</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Processing 11 GTI files ...  11 files, 63635 intervals with 3,322 days live time
	cut from 63,635 to 0 - 4816, or 4,816 entries after MJD range selection
	GTI MJD range: 54682.66-55000.03, good fraction 0.82 
Processing 12 S/C history (FT2) files
  applying cuts cos(theta) &lt; 0.4,  z &lt; 100
	file /home/burnett/work/lat-data/ft2/ft2_2008.fits: 362996 entries, 360944 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2009.fits: 874661 entries, 392949 in GTI
	file /home/burnett/work/lat-data/ft2/ft2_2010.fits: quit, beyond range
	Found 753,893 S/C entries:  235,634 remain after zenith and theta cuts
	cut from 235,634 to 0 - 235575, or 235,575 entries after MJD range selection
Calculate exposure using the energy domain 100.0-1000000.0 4 bins/decade
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The result is a tuple of time intervals and the exposure</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exposure</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>start</th>
      <th>stop</th>
      <th>exposure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>54682.656038</td>
      <td>54682.656375</td>
      <td>112998.052089</td>
    </tr>
    <tr>
      <th>1</th>
      <td>54682.656375</td>
      <td>54682.656722</td>
      <td>116901.160578</td>
    </tr>
    <tr>
      <th>2</th>
      <td>54682.656722</td>
      <td>54682.657069</td>
      <td>116857.143435</td>
    </tr>
    <tr>
      <th>3</th>
      <td>54682.657069</td>
      <td>54682.657416</td>
      <td>116791.434285</td>
    </tr>
    <tr>
      <th>4</th>
      <td>54682.657416</td>
      <td>54682.657764</td>
      <td>116876.550059</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>753747</th>
      <td>54999.954488</td>
      <td>54999.954835</td>
      <td>44173.944047</td>
    </tr>
    <tr>
      <th>753748</th>
      <td>54999.954835</td>
      <td>54999.955183</td>
      <td>39003.896685</td>
    </tr>
    <tr>
      <th>753749</th>
      <td>54999.955183</td>
      <td>54999.955530</td>
      <td>33775.488160</td>
    </tr>
    <tr>
      <th>753818</th>
      <td>54999.999546</td>
      <td>54999.999893</td>
      <td>35121.038690</td>
    </tr>
    <tr>
      <th>753819</th>
      <td>54999.999893</td>
      <td>55000.000241</td>
      <td>39974.422715</td>
    </tr>
  </tbody>
</table>
<p>235575 rows Ã— 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># # cache?</span>
<span class="c1"># cache_folder = &#39;/tmp/light_curves/&#39;</span>
<span class="c1"># os.makedirs(cache_folder, exist_ok=True)</span>
<span class="c1"># fn = source.name.replace(&#39; &#39;, &#39;_&#39;).replace(&#39;+&#39;,&#39;p&#39;)</span>
<span class="c1"># filename = os.path.join(cache_folder, fn+&#39;.pkl&#39;)</span>
<span class="c1"># exposure.to_pickle( fn)</span>
<span class="c1"># print(f&#39;Exposure for {source.name}  saved to {filename}&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

