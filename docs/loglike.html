---

title: Log Likelihood tools


keywords: fastai
sidebar: home_sidebar

summary: "Evaluate the Kerr likelihood, fits using poisson, gaussian"
description: "Evaluate the Kerr likelihood, fits using poisson, gaussian"
nb_path: "nbs/08_loglike.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/08_loglike.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Kerr-likelihood-formula">The Kerr likelihood formula<a class="anchor-link" href="#The-Kerr-likelihood-formula"> </a></h3><p>For each cell with a set of photons with weights $w$, the log likelihood as a function of $\alpha$  and $\beta$ is</p>
<p>{% raw %}
$$ \displaystyle\log\mathcal{L}(\alpha,\beta\ |\ w)\ = \sum_{w}  \log \big( 1 + \alpha\ w + \beta\ (1-w) \big) - (\alpha\ S + \beta\ B) $$
{% endraw %}</p>
<p>where  $\alpha$ and $\beta$ are the excess signal, and background fractions, and $S$ and $B$ are
the expected numbers of signal and background counts for the cell, determined from the full data set and relative exposure for the cell.</p>
<p>Usually, we assume $\beta=0$, that the background is not varying, and look for signal variation.</p>
<p>In the special case where all $w$ values are 1, this reduces to Poisson likelihood, with solution $\alpha = (1-n/S)$,
where $n$ is the the number of photons.</p>
<p>This module uses this functional evaluation of the likelihood for a cell to define the poisson-like
3-parameter function to approximate this likelihood.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LogLike" class="doc_header"><code>class</code> <code>LogLike</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/loglike.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LogLike</code>(<strong><code>cell</code></strong>)</p>
</blockquote>
<p>implement Kerr Eqn 2 for a single interval, or cell</p>
<ul>
<li>cell -- a dict with  w, S, B <br>
<pre><code> w may be an array of np.uint8: if so, divide by 256</code></pre>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example">Example<a class="anchor-link" href="#Example"> </a></h3><p>Create a cell for further tests. Plot the likelihood for a cell with 100 weights</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">cell</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">20</span> <span class="p">)</span>

<span class="n">ll</span> <span class="o">=</span> <span class="n">LogLike</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
<span class="n">ll</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>__main__.LogLike:  100 weights, S 80.0, B 20.0
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GaussianRep" class="doc_header"><code>class</code> <code>GaussianRep</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/loglike.py#L199" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GaussianRep</code>(<strong><code>loglike</code></strong>, <strong><code>fix_beta</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Manage fits to the loglike object</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-1-D-gaussian-fit-parameters">The 1-D gaussian fit parameters<a class="anchor-link" href="#The-1-D-gaussian-fit-parameters"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gr</span> <span class="o">=</span> <span class="n">GaussianRep</span><span class="p">(</span><span class="n">ll</span><span class="p">);</span> <span class="n">gr</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>__main__.GaussianRep:
counts      100.000
flux          1.000
sig_flux      0.125
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Gaussian2dRep" class="doc_header"><code>class</code> <code>Gaussian2dRep</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/loglike.py#L215" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Gaussian2dRep</code>(<strong><code>loglike</code></strong>) :: <a href="/light_curves/loglike.html#GaussianRep"><code>GaussianRep</code></a></p>
</blockquote>
<p>Manage fits to the loglike object</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PoissonRep" class="doc_header"><code>class</code> <code>PoissonRep</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/loglike.py#L220" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PoissonRep</code>(<strong><code>loglike</code></strong>, <strong><code>tol</code></strong>=<em><code>0.2</code></em>)</p>
</blockquote>
<p>Manage the representation of the log likelihood of a cell by a Poisson.</p>
<p>Constructor takes a <a href="/light_curves/loglike.html#LogLike"><code>LogLike</code></a> object, fits it to the poisson-like function (see <a href="/light_curves/poisson.html#Poisson"><code>Poisson</code></a>), and
defines a function to evaluate that.</p>
<p>Note that beta is set to zero (for now).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Poisson-representation">Poisson representation<a class="anchor-link" href="#Poisson-representation"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">info</span> <span class="o">=</span> <span class="n">ll</span><span class="o">.</span><span class="n">fit_info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;LogLike fit info:</span><span class="si">{</span><span class="n">info</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">PoissonRep</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PoissonRep: </span><span class="si">{</span><span class="n">pr</span><span class="si">}</span><span class="s1">, poiss: </span><span class="si">{</span><span class="n">pr</span><span class="o">.</span><span class="n">poiss</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;poisson pars: </span><span class="si">{</span><span class="n">pars</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Get poisson parmeters from n=</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="si">}</span><span class="s1">, m=</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1">, sig=</span><span class="si">{</span><span class="n">sig</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">sig</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">beta</span><span class="o">/</span><span class="n">e</span>
<span class="n">pois</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span> <span class="p">,</span> <span class="n">b</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pois</span><span class="p">,</span> <span class="n">pois</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>LogLike fit info:{&#39;counts&#39;: 100, &#39;flux&#39;: 1.0, &#39;sig_flux&#39;: 0.125}
PoissonRep:   1.000[1+0.121-0.129], &lt; 1.23, poiss: Poisson: mu,beta= 100.0, 20.0
poisson pars: [ 1.    79.992  0.25 ]
Get poisson parmeters from n=100, m=1.0, sig=0.125
Poisson: mu,beta= 100.0, 20.0 [1.0, 80.0, 0.25]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PoissonRepTable" class="doc_header"><code>class</code> <code>PoissonRepTable</code><a href="https://github.com/tburnett/light_curves/tree/master/light_curves/loglike.py#L319" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PoissonRepTable</code>(<strong><code>loglike</code></strong>) :: <a href="/light_curves/loglike.html#PoissonRep"><code>PoissonRep</code></a></p>
</blockquote>
<p>Create a table, then interpolate it</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prt</span> <span class="o">=</span> <span class="n">PoissonRepTable</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
<span class="n">prt</span><span class="o">.</span><span class="n">dom</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.5025122655712322, 1.7019492714254052, 100)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

